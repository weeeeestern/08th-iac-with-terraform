# 주제

테라폼 라이선스 이슈와 OpenTofu의 등장

# 요약

- 2023년 8월, 하시코프(HashiCorp)가 테라폼 라이선스를 MPL(오픈소스)에서 BSL(상업적 제한)로 변경함.
- BSL의 Additional User Grant 조항이 하시코프와 '경쟁하는' 상업적 사용을 금지하며 논란이 시작됨.
- 이에 반발한 커뮤니티와 기업들이 연합해, 마지막 MPL 버전 기반의 오픈소스 포크(Fork)인 'OpenTofu'를 런칭함.
- 이제 사용자는 원조 테라폼과 커뮤니티 주도의 OpenTofu 사이에서 라이선스 철학을 보고 선택해야 하는 상황임.

# 학습 내용

## 1. 사건의 발단: 라이선스 변경 (MPL → BSL)

- 하시코프가 기존에 쓰던 MPL 2.0(Mozilla Public License)은 OSI가 인정한 완전한 오픈소스 라이선스였음.
- 2023년 8월, BSL 1.1(Business Source License)로 변경을 선언함.
- BSL은 '소스 코드'는 볼 수 있으나, '사용'에 제한이 따르는 라이선스임.
- 하시코프의 명분: 다른 기업들이 테라폼 코드를 공짜로 가져가 자기들 상업적 경쟁 제품 만드는 걸 막기 위함이었음.
- BSL 라이선스는 '제외 목적(Excluded Purpose)'에 해당하는 사용을 금지함.
    - "하시코프의 어떤 제품(Offering)과 경쟁하는" 용도로는 테라폼 코드를 사용할 수 없음.
    - => 테라폼 기반으로 IaC 관리 도구 만들어 서비스 팔던 기업들은 '경쟁사'로 분류되어 최신 테라폼을 못 쓰게 됨 (사실상 이들을 겨냥한 조항)

## 3. 커뮤니티의 대응: OpenTofu의 탄생

- 라이선스 변경에 대한 'OpenTF'라는 선언문을 발표
    - "라이선스 롤백해달라. 안 해주면 우리끼리 포크해서 오픈소스로 계속 간다."
- 하시코프가 입장을 고수하자, 진짜로 포크를 진행함. (MPL 2.0 라이선스의 마지막 테라폼 버전(v1.5.5))
- 이후 리눅스 재단(Linux Foundation) 산하의 CNCF에 합류하며 'OpenTofu'라는 공식 이름을 갖게 됨.
- OpenTofu는 MPL 2.0 라이선스 하에 개발되는, 벤더 중립적인 완전한 오픈소스

# 추가

- 이 사태로 인해 개발자들은 선택의 기로에 섰음.
- **테라폼 (HashiCorp):** 원조 개발사의 지원, 하시코프 클라우드(HCS)와의 강력한 연동이 장점. BSL 라이선스로 인한 벤더 종속성 우려가 단점. (내부 인프라 관리용으로만 쓰면 BSL도 상관없음)
- **OpenTofu (CNCF):** 완전한 오픈소스(MPL), 커뮤니티 주도, 벤더 중립성이 장점. 신생 프로젝트라 생태계 성숙도나 안정성은 시간이 좀 필요함.
- 결론: 이제 IaC 도구 선택은 단순 기능이 아니라 라이선스 철학까지 고려해야 하는 시대가 되었음.

# 추가

- **OpenTofu에 추가된 주요 기능 (Terraform에 없음):**
    - **1. 클라이언트 측 상태 파일 암호화 (1.7+):**
        - 현재 가장 큰 기능적 차이점임.
        - 상태 파일을 원격 백엔드(S3 등)로 보내기 *전*에 로컬에서 먼저 암호화함. (KMS 등 연동)
        - 기존 테라폼의 '서버 측 암호화'보다 강력한 보안을 제공함.
    - **2. "초기 평가" (Early Evaluation) (1.8+):**
        - 테라폼 유저들의 오랜 숙원이었던 기능임.
        - `backend`나 `module` `source` 같이 `init` 단계에서 읽는 블록에 `locals`, `variables` 사용이 가능해짐.
        - 환경별로 백엔드 설정 동적으로 구성하기 매우 편해짐. (래퍼 스크립트 불필요)
    - **3. 고급 테스트 기능 (Provider Mocking) (1.8+):**
        - `tofu test`가 강력해짐.
        - 실제 리소스 생성 없이 프로바이더 동작을 모방(Mocking)하여 CI에서 빠르고 비용 없이 테스트 가능함.
    - **4. `.tofu` 오버라이드 파일 (1.8+):**
        - `.tf` 파일과 `.tofu` 파일이 같이 있으면, OpenTofu는 `.tofu` 파일만 읽음.
        - 테라폼/OpenTofu 호환 모듈을 만들 때 OpenTofu 전용 코드를 분리하기 좋음.

- **같은 기간 Terraform에 추가된 주요 기능:**
    - **1. 프로바이더 정의 함수 (Provider-Defined Functions):**
        - AWS 같은 프로바이더가 HCL에서 쓸 수 있는 자체 함수를 제공할 수 있게 됨.
    - **2. `removed{}` 블록 개선:**
        - 리소스 제거 시 상태 파일 관리를 더 편하게 할 수 있도록 기능이 개선됨.

- 단순히 라이선스뿐만 아니라, **필요한 기능이 어느 쪽에 구현되었는지**를 보고 선택해야 하는 시점이 되었음.
- OpenTofu는 커뮤니티가 원했던 보안/편의 기능을, Terraform은 하시코프의 로드맵을 따라가는 중임.